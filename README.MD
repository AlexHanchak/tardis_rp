üõ†Ô∏è 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞: Spring Boot + TelegramBots API
‚úÖ –®–∞–≥ 1: –£–±–µ–¥–∏—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
Java 17+ (–ø—Ä–æ–≤–µ—Ä—å: java -version)
Maven (–ø—Ä–æ–≤–µ—Ä—å: mvn -version)
IntelliJ IDEA CE (–∏–ª–∏ –¥—Ä—É–≥–æ–π —Ä–µ–¥–∞–∫—Ç–æ—Ä)
‚úÖ –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ Spring Boot
–û—Ç–∫—Ä–æ–π IntelliJ IDEA –∏ –≤—ã–±–µ—Ä–∏:
File ‚Üí New Project ‚Üí Spring Boot
–î–æ–±–∞–≤—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
Spring Web (–¥–ª—è REST –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏).
Spring Boot Starter (–æ—Å–Ω–æ–≤–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è).
–ò–ª–∏ —Å–æ–∑–¥–∞–π –ø—Ä–æ–µ–∫—Ç —á–µ—Ä–µ–∑ Spring Initializr.

‚úÖ –®–∞–≥ 3: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ TelegramBots API
–î–æ–±–∞–≤—å –≤ pom.xml:

xml
Kopieren
Bearbeiten
<dependencies>
<!-- Telegram Bots API -->
<dependency>
<groupId>org.telegram</groupId>
<artifactId>telegrambots-spring-boot-starter</artifactId>
<version>6.9.7</version>
</dependency>
</dependencies>
–ó–∞—Ç–µ–º –æ–±–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

bash
Kopieren
Bearbeiten
mvn clean install
üì¶ 2. –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±–æ—Ç–∞
‚úÖ –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (—Ç–æ–∫–µ–Ω –∏ –∏–º—è –±–æ—Ç–∞)
–í —Ñ–∞–π–ª–µ application.properties –¥–æ–±–∞–≤—å:

properties
Kopieren
Bearbeiten
telegram.bot.username=YourBotUsername
telegram.bot.token=YourTelegramBotToken
–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –º–æ–∂–Ω–æ —É @BotFather –≤ Telegram:

–ù–∞–ø–∏—à–∏ /newbot.
–£–∫–∞–∂–∏ –∏–º—è –∏ —é–∑–µ—Ä–Ω–µ–π–º.
–°–∫–æ–ø–∏—Ä—É–π —Ç–æ–∫–µ–Ω.
‚úÖ –®–∞–≥ 2: –°–æ–∑–¥–∞—ë–º –±–∞–∑–æ–≤–æ–≥–æ Telegram-–±–æ—Ç–∞
BotApplication.java ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞:

java
Kopieren
Bearbeiten
package com.example.telegrambot;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class BotApplication {
public static void main(String[] args) {
SpringApplication.run(BotApplication.class, args);
}
}
MyTelegramBot.java ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞:

java
Kopieren
Bearbeiten
package com.example.telegrambot;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;
import org.telegram.telegrambots.bots.TelegramLongPollingBot;
import org.telegram.telegrambots.meta.api.methods.send.SendMessage;
import org.telegram.telegrambots.meta.api.objects.Update;
import org.telegram.telegrambots.meta.exceptions.TelegramApiException;

@Component
public class MyTelegramBot extends TelegramLongPollingBot {

    @Value("${telegram.bot.username}")
    private String botUsername;

    @Value("${telegram.bot.token}")
    private String botToken;

    @Override
    public String getBotUsername() {
        return botUsername;
    }

    @Override
    public String getBotToken() {
        return botToken;
    }

    @Override
    public void onUpdateReceived(Update update) {
        if (update.hasMessage() && update.getMessage().hasText()) {
            String messageText = update.getMessage().getText();
            long chatId = update.getMessage().getChatId();

            if ("/start".equals(messageText)) {
                sendTextMessage(chatId, "–ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à Telegram-–±–æ—Ç –Ω–∞ Spring Boot. üöÄ");
            } else {
                sendTextMessage(chatId, "–í—ã –Ω–∞–ø–∏—Å–∞–ª–∏: " + messageText);
            }
        }
    }

    private void sendTextMessage(Long chatId, String text) {
        SendMessage message = new SendMessage();
        message.setChatId(String.valueOf(chatId));
        message.setText(text);
        try {
            execute(message);
        } catch (TelegramApiException e) {
            e.printStackTrace();
        }
    }
}
‚úÖ –®–∞–≥ 3: –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
–°–æ–±–µ—Ä–∏ –ø—Ä–æ–µ–∫—Ç:
bash
Kopieren
Bearbeiten
mvn clean package
–ó–∞–ø—É—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
bash
Kopieren
Bearbeiten
mvn spring-boot:run
–ï—Å–ª–∏ –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –±–æ—Ç –æ—Ç–≤–µ—Ç–∏—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—É /start. üéâ

üóÇÔ∏è 3. –†–∞—Å—à–∏—Ä—è–µ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –±–æ—Ç–∞
‚úÖ –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–º–∞–Ω–¥—ã (Command Pattern)
–°–æ–∑–¥–∞–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∫–æ–º–∞–Ω–¥:

BotCommand.java

java
Kopieren
Bearbeiten
package com.example.telegrambot.commands;

import org.telegram.telegrambots.meta.api.objects.Update;

public interface BotCommand {
void execute(Update update);
String getCommand();
}
–†–µ–∞–ª–∏–∑—É–π –∫–æ–º–∞–Ω–¥—É /help:

HelpCommand.java

java
Kopieren
Bearbeiten
package com.example.telegrambot.commands;

import org.springframework.stereotype.Component;
import org.telegram.telegrambots.meta.api.objects.Update;
import org.telegram.telegrambots.meta.api.methods.send.SendMessage;
import org.telegram.telegrambots.meta.exceptions.TelegramApiException;
import com.example.telegrambot.MyTelegramBot;

@Component
public class HelpCommand implements BotCommand {

    private final MyTelegramBot bot;

    public HelpCommand(MyTelegramBot bot) {
        this.bot = bot;
    }

    @Override
    public void execute(Update update) {
        String helpMessage = "–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n"
                + "/start - –ù–∞—á–∞—Ç—å\n"
                + "/help - –°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥";
        long chatId = update.getMessage().getChatId();
        try {
            bot.execute(new SendMessage(String.valueOf(chatId), helpMessage));
        } catch (TelegramApiException e) {
            e.printStackTrace();
        }
    }

    @Override
    public String getCommand() {
        return "/help";
    }
}
‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥ –≤ –±–æ—Ç–∞:
–î–æ–±–∞–≤—å –∫–æ–º–∞–Ω–¥–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤ MyTelegramBot:

java
Kopieren
Bearbeiten
private final List<BotCommand> commands;

public MyTelegramBot(List<BotCommand> commands) {
this.commands = commands;
}
–í –º–µ—Ç–æ–¥–µ onUpdateReceived() –¥–æ–±–∞–≤—å:

java
Kopieren
Bearbeiten
for (BotCommand command : commands) {
if (messageText.startsWith(command.getCommand())) {
command.execute(update);
return;
}
}
üóÉÔ∏è 4. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö (MySQL)
–î–æ–±–∞–≤—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

xml
Kopieren
Bearbeiten
<dependency>
<groupId>mysql</groupId>
<artifactId>mysql-connector-java</artifactId>
<version>8.0.33</version>
</dependency>
<dependency>
<groupId>org.springframework.boot</groupId>
<artifactId>spring-boot-starter-data-jpa</artifactId>
</dependency>
–ù–∞—Å—Ç—Ä–æ–π –±–∞–∑—É –≤ application.properties:

properties
Kopieren
Bearbeiten
spring.datasource.url=jdbc:mysql://localhost:3306/telegram_bot
spring.datasource.username=your_db_user
spring.datasource.password=your_db_password
spring.jpa.hibernate.ddl-auto=update
–°–æ–∑–¥–∞–π User-—Å—É—â–Ω–æ—Å—Ç—å:

java
Kopieren
Bearbeiten
@Entity
public class User {
@Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
private Long id;
private Long chatId;
private String username;
}
–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

java
Kopieren
Bearbeiten
public interface UserRepository extends JpaRepository<User, Long> {
Optional<User> findByChatId(Long chatId);
}
üìä 5. –ò—Ç–æ–≥: –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —É–º–µ–µ—Ç —Ç–≤–æ–π –±–æ—Ç?
‚úÖ –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:

–†–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã (/start, /help).
–†–∞—Å—à–∏—Ä—è–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –Ω–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥.
‚úÖ –ì–æ—Ç–æ–≤ –∫ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é:

–õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, —Ä–∞—Å—Å—ã–ª–∫–∞).
–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å.
üí¨ –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º –ª–æ–≥–∏–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –∏–ª–∏ API)? –î–∞–π –∑–Ω–∞—Ç—å, –∏ —è –ø–æ–º–æ–≥—É! üòä

Du:
–®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ Spring Boot
–û—Ç–∫—Ä–æ–π IntelliJ IDEA –∏ –≤—ã–±–µ—Ä–∏:
File ‚Üí New Project ‚Üí Spring Boot
–î–æ–±–∞–≤—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
Spring Web (–¥–ª—è REST –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏).
Spring Boot Starter (–æ—Å–Ω–æ–≤–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è).



–≤–æ—Ç –∑–¥–µ—Å—å —Å–º–æ—Ç—Ä—é —á—Ç–æ –Ω–µ—Ç—É Spring Boot Starter (–æ—Å–Ω–æ–≤–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è).
—è —Å–æ–∑–¥–∞—é —á–µ—Ä–µ–∑ —Å–∞–π—Ç https://start.spring.io/

—Ö–æ—Ä–æ—à–æ, –º–µ–Ω—è –µ—â–µ –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç —á—Ç–æ –±  –æ–π —Ç–≥ –±–æ—Ç –º–æ–≥ –æ–±—Ä–∞—â–∞—Ç—Å—è –∫ —Ä–∞—Å–ø–±–µ—Ä–∏ –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∏ –æ–±—â–∞—Ç—Å—è —Å mysql –∞ —Ç–∞–∫ –∂–µ –¥–µ–ª–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –∫–æ–º–∞–Ω–¥–∞–º —Ä–∞—Å–ø–±–µ—Ä–∏ –Ω–∞–ø—Ä–∏–º–µ—Ä —É–∑–Ω–∞–≤–∞—Ç—å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É —Ä–∞—Å–ø–±–µ—Ä–∏ –∏–ª–∏ –ø–æ–ª—É—á–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∫–∞–∫–∏–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç
–∫–∞–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–Ω–µ –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ—â–µ?

4/4

ChatGPT:
Erinnerung aktualisiert
–ü–æ–Ω—è–ª! –î–∞–≤–∞–π –Ω–∞—Å—Ç—Ä–æ–∏–º Spring Boot + Telegram-–±–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π:

–ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ MySQL –Ω–∞ Raspberry Pi.
–í—ã–ø–æ–ª–Ω—è–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –Ω–∞ Raspberry Pi (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, —Å–µ—Ä–≤–∏—Å—ã –∏ —Ç. –¥.).
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ Telegram.
‚úÖ 1. –ö–∞–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤–∏—Ç—å?
–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ start.spring.io –≤—ã–±–µ—Ä–∏ –∏–ª–∏ –¥–æ–±–∞–≤—å –≤ pom.xml:

xml
Kopieren
Bearbeiten
<dependencies>
<!-- Telegram Bots API -->
<dependency>
<groupId>org.telegram</groupId>
<artifactId>telegrambots-spring-boot-starter</artifactId>
<version>6.9.7</version>
</dependency>

    <!-- Spring Web (REST –∏ HTTP-–∑–∞–ø—Ä–æ—Å—ã) -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>

    <!-- Spring Data JPA (—Ä–∞–±–æ—Ç–∞ —Å MySQL) -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-data-jpa</artifactId>
    </dependency>

    <!-- MySQL Connector (–¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ MySQL) -->
    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>8.0.33</version>
    </dependency>
</dependencies>
‚úÖ 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ MySQL –Ω–∞ Raspberry Pi
–í —Ñ–∞–π–ª–µ application.properties –¥–æ–±–∞–≤—å:

properties
Kopieren
Bearbeiten
# –î–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ MySQL –Ω–∞ Raspberry Pi
spring.datasource.url=jdbc:mysql://<IP_RASPBERRY_PI>:3306/telegram_bot
spring.datasource.username=your_mysql_user
spring.datasource.password=your_mysql_password
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
üìå –ó–∞–º–µ–Ω–∏—Ç–µ:

<IP_RASPBERRY_PI> ‚Äî IP-–∞–¥—Ä–µ—Å Raspberry Pi (—É–∑–Ω–∞—Ç—å: hostname -I).
your_mysql_user –∏ your_mysql_password ‚Äî —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ MySQL.
–ï—Å–ª–∏ MySQL –µ—â—ë –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ Raspberry Pi:

bash
Kopieren
Bearbeiten
sudo apt update && sudo apt install mysql-server
sudo systemctl enable mysql && sudo systemctl start mysql
–ù–∞—Å—Ç—Ä–æ–π –¥–æ—Å—Ç—É–ø —Å –¥—Ä—É–≥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:

bash
Kopieren
Bearbeiten
sudo mysql -u root -p
–í—ã–ø–æ–ª–Ω–∏ –≤ MySQL:

sql
Kopieren
Bearbeiten
CREATE DATABASE telegram_bot;
CREATE USER 'your_mysql_user'@'%' IDENTIFIED BY 'your_mysql_password';
GRANT ALL PRIVILEGES ON telegram_bot.* TO 'your_mysql_user'@'%';
FLUSH PRIVILEGES;
‚úÖ 3. –°–æ–∑–¥–∞–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π
–°–æ–∑–¥–∞–π —Ç–∞–±–ª–∏—Ü—É –≤ –±–∞–∑–µ –Ω–∞ Raspberry Pi:

sql
Kopieren
Bearbeiten
CREATE TABLE system_logs (
id BIGINT AUTO_INCREMENT PRIMARY KEY,
command VARCHAR(255) NOT NULL,
output TEXT NOT NULL,
timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
–°–æ–∑–¥–∞–π –º–æ–¥–µ–ª—å –≤ Java:

java
Kopieren
Bearbeiten
@Entity
public class SystemLog {
@Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
private Long id;
private String command;
private String output;
private LocalDateTime timestamp = LocalDateTime.now();

    // Getters –∏ Setters
}
‚úÖ 4. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è –∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö –≤ MySQL
–°–æ–∑–¥–∞–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö:

java
Kopieren
Bearbeiten
@Repository
public interface SystemLogRepository extends JpaRepository<SystemLog, Long> {
}
‚úÖ 5. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –Ω–∞ Raspberry Pi
–°–æ–∑–¥–∞–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–º–∞–Ω–¥:

java
Kopieren
Bearbeiten
@Service
public class SystemCommandService {
private final SystemLogRepository logRepository;

    public SystemCommandService(SystemLogRepository logRepository) {
        this.logRepository = logRepository;
    }

    public String executeCommand(String command) {
        try {
            Process process = Runtime.getRuntime().exec(command);
            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String output = reader.lines().collect(Collectors.joining("\n"));
            process.waitFor();

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –±–∞–∑–µ
            logRepository.save(new SystemLog(command, output));
            return output;
        } catch (IOException | InterruptedException e) {
            return "–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: " + e.getMessage();
        }
    }
}
‚úÖ 6. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram-–±–æ—Ç–æ–º
–í –±–æ—Ç–µ –¥–æ–±–∞–≤–∏–º –∫–æ–º–∞–Ω–¥—É –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –¥–∞–Ω–Ω—ã—Ö —Å Raspberry Pi.

java
Kopieren
Bearbeiten
@Component
public class MyTelegramBot extends TelegramLongPollingBot {
private final SystemCommandService commandService;

    @Value("${telegram.bot.token}")
    private String botToken;

    @Value("${telegram.bot.username}")
    private String botUsername;

    public MyTelegramBot(SystemCommandService commandService) {
        this.commandService = commandService;
    }

    @Override
    public String getBotToken() {
        return botToken;
    }

    @Override
    public String getBotUsername() {
        return botUsername;
    }

    @Override
    public void onUpdateReceived(Update update) {
        if (update.hasMessage() && update.getMessage().hasText()) {
            String messageText = update.getMessage().getText();
            Long chatId = update.getMessage().getChatId();

            if ("/start".equals(messageText)) {
                sendMessage(chatId, "–ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç Raspberry Pi.");
            } else if ("/temp".equals(messageText)) {
                String result = commandService.executeCommand("vcgencmd measure_temp");
                sendMessage(chatId, "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: " + result);
            } else if ("/services".equals(messageText)) {
                String result = commandService.executeCommand("systemctl list-units --type=service");
                sendMessage(chatId, "–°–µ—Ä–≤–∏—Å—ã:\n" + result);
            } else {
                sendMessage(chatId, "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞.");
            }
        }
    }

    private void sendMessage(Long chatId, String text) {
        try {
            execute(new SendMessage(String.valueOf(chatId), text));
        } catch (TelegramApiException e) {
            e.printStackTrace();
        }
    }
}
‚úÖ 7. –ó–∞–ø—É—Å–∫ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞
–°–æ–±–µ—Ä–∏ –∏ –∑–∞–ø—É—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç:
bash
Kopieren
Bearbeiten
mvn clean package
mvn spring-boot:run
–ü—Ä–æ–≤–µ—Ä—å —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞:
/start ‚Äî –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ.
/temp ‚Äî —É–∑–Ω–∞–µ—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É Raspberry Pi.
/services ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã.
üìä 8. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
IP-–∞–¥—Ä–µ—Å: /ip ‚Äî hostname -I
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ CPU: /cpu ‚Äî top -bn1 | grep "Cpu(s)"
–°–≤–æ–±–æ–¥–Ω–∞—è –ø–∞–º—è—Ç—å: /mem ‚Äî free -m
–ï—Å–ª–∏ —Ö–æ—á–µ—à—å —Ä–∞—Å—à–∏—Ä–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∏–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ Pi –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è) ‚Äî –¥–∞–π –∑–Ω–∞—Ç—å! üòä